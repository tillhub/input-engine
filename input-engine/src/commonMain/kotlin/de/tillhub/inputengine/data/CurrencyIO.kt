package de.tillhub.inputengine.data

import kotlinx.serialization.Serializable

@Serializable
class CurrencyIO private constructor(
    val code: CurrencyCode,
    val defaultFractionDigits: Int,
    val numericCode: Int,
) {
    override fun toString(): String =
        code.toString()
    companion object {
        // https://www.currency-iso.org/en/home/tables/table-a1.html
        val all: Set<CurrencyIO> = hashSetOf(
            make(isoCode = "AED", defaultFractionDigits = 2, numericCode = 784),
            make(isoCode = "AFN", defaultFractionDigits = 2, numericCode = 971),
            make(isoCode = "ALL", defaultFractionDigits = 2, numericCode = 8),
            make(isoCode = "AMD", defaultFractionDigits = 2, numericCode = 51),
            make(isoCode = "ANG", defaultFractionDigits = 2, numericCode = 532),
            make(isoCode = "AOA", defaultFractionDigits = 2, numericCode = 973),
            make(isoCode = "ARS", defaultFractionDigits = 2, numericCode = 32),
            make(isoCode = "AUD", defaultFractionDigits = 2, numericCode = 36),
            make(isoCode = "AWG", defaultFractionDigits = 2, numericCode = 533),
            make(isoCode = "AZN", defaultFractionDigits = 2, numericCode = 944),
            make(isoCode = "BAM", defaultFractionDigits = 2, numericCode = 977),
            make(isoCode = "BBD", defaultFractionDigits = 2, numericCode = 52),
            make(isoCode = "BDT", defaultFractionDigits = 2, numericCode = 50),
            make(isoCode = "BGN", defaultFractionDigits = 2, numericCode = 975),
            make(isoCode = "BHD", defaultFractionDigits = 3, numericCode = 48),
            make(isoCode = "BIF", defaultFractionDigits = 0, numericCode = 108),
            make(isoCode = "BMD", defaultFractionDigits = 2, numericCode = 60),
            make(isoCode = "BND", defaultFractionDigits = 2, numericCode = 96),
            make(isoCode = "BOB", defaultFractionDigits = 2, numericCode = 68),
            make(isoCode = "BOV", defaultFractionDigits = 2, numericCode = 984),
            make(isoCode = "BRL", defaultFractionDigits = 2, numericCode = 986),
            make(isoCode = "BSD", defaultFractionDigits = 2, numericCode = 44),
            make(isoCode = "BTN", defaultFractionDigits = 2, numericCode = 64),
            make(isoCode = "BWP", defaultFractionDigits = 2, numericCode = 72),
            make(isoCode = "BYN", defaultFractionDigits = 2, numericCode = 933),
            make(isoCode = "BZD", defaultFractionDigits = 2, numericCode = 84),
            make(isoCode = "CAD", defaultFractionDigits = 2, numericCode = 124),
            make(isoCode = "CDF", defaultFractionDigits = 2, numericCode = 976),
            make(isoCode = "CHE", defaultFractionDigits = 2, numericCode = 947),
            make(isoCode = "CHF", defaultFractionDigits = 2, numericCode = 756),
            make(isoCode = "CHW", defaultFractionDigits = 2, numericCode = 948),
            make(isoCode = "CLF", defaultFractionDigits = 4, numericCode = 990),
            make(isoCode = "CLP", defaultFractionDigits = 0, numericCode = 152),
            make(isoCode = "CNY", defaultFractionDigits = 2, numericCode = 156),
            make(isoCode = "COP", defaultFractionDigits = 2, numericCode = 170),
            make(isoCode = "COU", defaultFractionDigits = 2, numericCode = 970),
            make(isoCode = "CRC", defaultFractionDigits = 2, numericCode = 188),
            make(isoCode = "CUC", defaultFractionDigits = 2, numericCode = 931),
            make(isoCode = "CUP", defaultFractionDigits = 2, numericCode = 192),
            make(isoCode = "CVE", defaultFractionDigits = 2, numericCode = 132),
            make(isoCode = "CZK", defaultFractionDigits = 2, numericCode = 203),
            make(isoCode = "DJF", defaultFractionDigits = 0, numericCode = 262),
            make(isoCode = "DKK", defaultFractionDigits = 2, numericCode = 208),
            make(isoCode = "DOP", defaultFractionDigits = 2, numericCode = 214),
            make(isoCode = "DZD", defaultFractionDigits = 2, numericCode = 12),
            make(isoCode = "EGP", defaultFractionDigits = 2, numericCode = 818),
            make(isoCode = "ERN", defaultFractionDigits = 2, numericCode = 232),
            make(isoCode = "ETB", defaultFractionDigits = 2, numericCode = 230),
            make(isoCode = "EUR", defaultFractionDigits = 2, numericCode = 978),
            make(isoCode = "FJD", defaultFractionDigits = 2, numericCode = 242),
            make(isoCode = "FKP", defaultFractionDigits = 2, numericCode = 238),
            make(isoCode = "GBP", defaultFractionDigits = 2, numericCode = 826),
            make(isoCode = "GEL", defaultFractionDigits = 2, numericCode = 981),
            make(isoCode = "GHS", defaultFractionDigits = 2, numericCode = 936),
            make(isoCode = "GIP", defaultFractionDigits = 2, numericCode = 292),
            make(isoCode = "GMD", defaultFractionDigits = 2, numericCode = 270),
            make(isoCode = "GNF", defaultFractionDigits = 0, numericCode = 324),
            make(isoCode = "GTQ", defaultFractionDigits = 2, numericCode = 320),
            make(isoCode = "GYD", defaultFractionDigits = 2, numericCode = 328),
            make(isoCode = "HKD", defaultFractionDigits = 2, numericCode = 344),
            make(isoCode = "HNL", defaultFractionDigits = 2, numericCode = 340),
            make(isoCode = "HRK", defaultFractionDigits = 2, numericCode = 191),
            make(isoCode = "HTG", defaultFractionDigits = 2, numericCode = 332),
            make(isoCode = "HUF", defaultFractionDigits = 2, numericCode = 348),
            make(isoCode = "IDR", defaultFractionDigits = 2, numericCode = 360),
            make(isoCode = "ILS", defaultFractionDigits = 2, numericCode = 376),
            make(isoCode = "INR", defaultFractionDigits = 2, numericCode = 356),
            make(isoCode = "IQD", defaultFractionDigits = 3, numericCode = 368),
            make(isoCode = "IRR", defaultFractionDigits = 2, numericCode = 364),
            make(isoCode = "ISK", defaultFractionDigits = 0, numericCode = 352),
            make(isoCode = "JMD", defaultFractionDigits = 2, numericCode = 388),
            make(isoCode = "JOD", defaultFractionDigits = 3, numericCode = 400),
            make(isoCode = "JPY", defaultFractionDigits = 0, numericCode = 392),
            make(isoCode = "KES", defaultFractionDigits = 2, numericCode = 404),
            make(isoCode = "KGS", defaultFractionDigits = 2, numericCode = 417),
            make(isoCode = "KHR", defaultFractionDigits = 2, numericCode = 116),
            make(isoCode = "KMF", defaultFractionDigits = 0, numericCode = 174),
            make(isoCode = "KPW", defaultFractionDigits = 2, numericCode = 408),
            make(isoCode = "KRW", defaultFractionDigits = 0, numericCode = 410),
            make(isoCode = "KWD", defaultFractionDigits = 3, numericCode = 414),
            make(isoCode = "KYD", defaultFractionDigits = 2, numericCode = 136),
            make(isoCode = "KZT", defaultFractionDigits = 2, numericCode = 398),
            make(isoCode = "LAK", defaultFractionDigits = 2, numericCode = 418),
            make(isoCode = "LBP", defaultFractionDigits = 2, numericCode = 422),
            make(isoCode = "LKR", defaultFractionDigits = 2, numericCode = 144),
            make(isoCode = "LRD", defaultFractionDigits = 2, numericCode = 430),
            make(isoCode = "LSL", defaultFractionDigits = 2, numericCode = 426),
            make(isoCode = "LYD", defaultFractionDigits = 3, numericCode = 434),
            make(isoCode = "MAD", defaultFractionDigits = 2, numericCode = 504),
            make(isoCode = "MDL", defaultFractionDigits = 2, numericCode = 498),
            make(isoCode = "MGA", defaultFractionDigits = 2, numericCode = 969),
            make(isoCode = "MKD", defaultFractionDigits = 2, numericCode = 807),
            make(isoCode = "MMK", defaultFractionDigits = 2, numericCode = 104),
            make(isoCode = "MNT", defaultFractionDigits = 2, numericCode = 496),
            make(isoCode = "MOP", defaultFractionDigits = 2, numericCode = 446),
            make(isoCode = "MRU", defaultFractionDigits = 2, numericCode = 929),
            make(isoCode = "MUR", defaultFractionDigits = 2, numericCode = 480),
            make(isoCode = "MVR", defaultFractionDigits = 2, numericCode = 462),
            make(isoCode = "MWK", defaultFractionDigits = 2, numericCode = 454),
            make(isoCode = "MXN", defaultFractionDigits = 2, numericCode = 484),
            make(isoCode = "MXV", defaultFractionDigits = 2, numericCode = 979),
            make(isoCode = "MYR", defaultFractionDigits = 2, numericCode = 458),
            make(isoCode = "MZN", defaultFractionDigits = 2, numericCode = 943),
            make(isoCode = "NAD", defaultFractionDigits = 2, numericCode = 516),
            make(isoCode = "NGN", defaultFractionDigits = 2, numericCode = 566),
            make(isoCode = "NIO", defaultFractionDigits = 2, numericCode = 558),
            make(isoCode = "NOK", defaultFractionDigits = 2, numericCode = 578),
            make(isoCode = "NPR", defaultFractionDigits = 2, numericCode = 524),
            make(isoCode = "NZD", defaultFractionDigits = 2, numericCode = 554),
            make(isoCode = "OMR", defaultFractionDigits = 3, numericCode = 512),
            make(isoCode = "PAB", defaultFractionDigits = 2, numericCode = 590),
            make(isoCode = "PEN", defaultFractionDigits = 2, numericCode = 604),
            make(isoCode = "PGK", defaultFractionDigits = 2, numericCode = 598),
            make(isoCode = "PHP", defaultFractionDigits = 2, numericCode = 608),
            make(isoCode = "PKR", defaultFractionDigits = 2, numericCode = 586),
            make(isoCode = "PLN", defaultFractionDigits = 2, numericCode = 985),
            make(isoCode = "PYG", defaultFractionDigits = 0, numericCode = 600),
            make(isoCode = "QAR", defaultFractionDigits = 2, numericCode = 634),
            make(isoCode = "RON", defaultFractionDigits = 2, numericCode = 946),
            make(isoCode = "RSD", defaultFractionDigits = 2, numericCode = 941),
            make(isoCode = "RUB", defaultFractionDigits = 2, numericCode = 643),
            make(isoCode = "RWF", defaultFractionDigits = 0, numericCode = 646),
            make(isoCode = "SAR", defaultFractionDigits = 2, numericCode = 682),
            make(isoCode = "SBD", defaultFractionDigits = 2, numericCode = 90),
            make(isoCode = "SCR", defaultFractionDigits = 2, numericCode = 690),
            make(isoCode = "SDG", defaultFractionDigits = 2, numericCode = 938),
            make(isoCode = "SEK", defaultFractionDigits = 2, numericCode = 752),
            make(isoCode = "SGD", defaultFractionDigits = 2, numericCode = 702),
            make(isoCode = "SHP", defaultFractionDigits = 2, numericCode = 654),
            make(isoCode = "SLL", defaultFractionDigits = 2, numericCode = 694),
            make(isoCode = "SOS", defaultFractionDigits = 2, numericCode = 706),
            make(isoCode = "SRD", defaultFractionDigits = 2, numericCode = 968),
            make(isoCode = "SSP", defaultFractionDigits = 2, numericCode = 728),
            make(isoCode = "STN", defaultFractionDigits = 2, numericCode = 930),
            make(isoCode = "SVC", defaultFractionDigits = 2, numericCode = 222),
            make(isoCode = "SYP", defaultFractionDigits = 2, numericCode = 760),
            make(isoCode = "SZL", defaultFractionDigits = 2, numericCode = 748),
            make(isoCode = "THB", defaultFractionDigits = 2, numericCode = 764),
            make(isoCode = "TJS", defaultFractionDigits = 2, numericCode = 972),
            make(isoCode = "TMT", defaultFractionDigits = 2, numericCode = 934),
            make(isoCode = "TND", defaultFractionDigits = 3, numericCode = 788),
            make(isoCode = "TOP", defaultFractionDigits = 2, numericCode = 776),
            make(isoCode = "TRY", defaultFractionDigits = 2, numericCode = 949),
            make(isoCode = "TTD", defaultFractionDigits = 2, numericCode = 780),
            make(isoCode = "TWD", defaultFractionDigits = 2, numericCode = 901),
            make(isoCode = "TZS", defaultFractionDigits = 2, numericCode = 834),
            make(isoCode = "UAH", defaultFractionDigits = 2, numericCode = 980),
            make(isoCode = "UGX", defaultFractionDigits = 0, numericCode = 800),
            make(isoCode = "USD", defaultFractionDigits = 2, numericCode = 840),
            make(isoCode = "USN", defaultFractionDigits = 2, numericCode = 997),
            make(isoCode = "UYI", defaultFractionDigits = 0, numericCode = 940),
            make(isoCode = "UYU", defaultFractionDigits = 2, numericCode = 858),
            make(isoCode = "UYW", defaultFractionDigits = 4, numericCode = 927),
            make(isoCode = "UZS", defaultFractionDigits = 2, numericCode = 860),
            make(isoCode = "VES", defaultFractionDigits = 2, numericCode = 928),
            make(isoCode = "VND", defaultFractionDigits = 0, numericCode = 704),
            make(isoCode = "VUV", defaultFractionDigits = 0, numericCode = 548),
            make(isoCode = "WST", defaultFractionDigits = 2, numericCode = 882),
            make(isoCode = "XAF", defaultFractionDigits = 0, numericCode = 950),
            make(isoCode = "XAG", defaultFractionDigits = -1, numericCode = 961),
            make(isoCode = "XAU", defaultFractionDigits = -1, numericCode = 959),
            make(isoCode = "XBA", defaultFractionDigits = -1, numericCode = 955),
            make(isoCode = "XBB", defaultFractionDigits = -1, numericCode = 956),
            make(isoCode = "XBC", defaultFractionDigits = -1, numericCode = 957),
            make(isoCode = "XBD", defaultFractionDigits = -1, numericCode = 958),
            make(isoCode = "XCD", defaultFractionDigits = 2, numericCode = 951),
            make(isoCode = "XDR", defaultFractionDigits = -1, numericCode = 960),
            make(isoCode = "XOF", defaultFractionDigits = 0, numericCode = 952),
            make(isoCode = "XPD", defaultFractionDigits = -1, numericCode = 964),
            make(isoCode = "XPF", defaultFractionDigits = 0, numericCode = 953),
            make(isoCode = "XPT", defaultFractionDigits = -1, numericCode = 962),
            make(isoCode = "XSU", defaultFractionDigits = -1, numericCode = 994),
            make(isoCode = "XTS", defaultFractionDigits = -1, numericCode = 963),
            make(isoCode = "XUA", defaultFractionDigits = -1, numericCode = 965),
            make(isoCode = "XXX", defaultFractionDigits = -1, numericCode = 999),
            make(isoCode = "YER", defaultFractionDigits = 2, numericCode = 886),
            make(isoCode = "ZAR", defaultFractionDigits = 2, numericCode = 710),
            make(isoCode = "ZMW", defaultFractionDigits = 2, numericCode = 967),
            make(isoCode = "ZWL", defaultFractionDigits = 2, numericCode = 932),
        )
        private val allByCode: Map<CurrencyCode, CurrencyIO> = all.associateByTo(hashMapOf()) { it.code }

        private fun make(isoCode: String, defaultFractionDigits: Int, numericCode: Int): CurrencyIO =
            CurrencyIO(
                code = CurrencyCode(isoCode),
                defaultFractionDigits = defaultFractionDigits,
                numericCode = numericCode,
            )

        fun forCode(code: CurrencyCode): CurrencyIO =
            forCodeOrNull(code) ?: error("Invalid ISO 4217 currency code: $code")

        fun forCodeOrNull(code: CurrencyCode): CurrencyIO? =
            allByCode[code]

        fun forCode(code: String): CurrencyIO =
            forCodeOrNull(CurrencyCode.Companion.parse(code)) ?: error("Invalid ISO 4217 currency code: $code")

        fun forCodeOrNull(code: String): CurrencyIO? =
            CurrencyCode.Companion.parseOrNull(code)?.let(::forCodeOrNull)
    }
}
